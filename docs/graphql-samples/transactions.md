# Transactions

## Paginate blockchain transactions

Sometimes it is needed to  paginate all the network transactions.&#x20;

Due to the fact that Everscale is a multi-chain multi-threaded blockchain, pagination is not a straightforward operation and requires some special cursor and order of blocks and transactions inside them.

We provide our users with such functionality.

Read more about the used cursor-based approach in [blocks pagination section.](blocks.md#blocks-pagination)

You can either paginate all workchains' transactions (if you omit `workchain` parameter) or only the specified workchain's transactions.

If you do not specify time range you will start pagination from the start (`first` parameter) or the end (`last` parameter) of the network.

Here is a simple query how to get last 3 transactions of the network and paginate backwards.

You can paginate from the beginning and specify masterchain seq\_no range or masterchain time range to paginate within some time period. Check how to define this range in[ blocks pagination section.](blocks.md#paginate\_by\_seqno)

```graphql
query{
  workchain_transactions(
    last:3
  ){
    edges{
      node{
        id
        now
      }
      cursor
    }
    pageInfo{
      startCursor
      hasPreviousPage
    }
  }
}
```

Result:

```graphql
{
  "data": {
    "workchain_transactions": {
      "edges": [
        {
          "node": {
            "id": "transaction/f9f6a2e6f0d82ed4c91432d15135481bc2744d1e57a5b198a4c4577c3c1556ea",
            "now": 1646867623
          },
          "cursor": "5eb8b7fm02"
        },
        {
          "node": {
            "id": "transaction/9491a1d47959670bbee2103c49f6ebd4000758773175b322c97171827852ba21",
            "now": 1646867623
          },
          "cursor": "5eb8b7fm03"
        },
        {
          "node": {
            "id": "transaction/3509cbd336d24d8ca7bcde8d4ef9212041ed09f7a5606c35e3aa6b56d9dfb2af",
            "now": 1646867623
          },
          "cursor": "5eb8b7fm04"
        }
      ],
      "pageInfo": {
        "startCursor": "5eb8b7fm02",
        "hasPreviousPage": true
      }
    }
  }
}
```

Use `startCursor` and `hasPreviousPage` == true condition to paginate backwards like this:

```graphql
query{
  workchain_transactions(
    last:3
    before:"5eb8b7fm02"
  ){
    edges{
      node{
        id
        now
      }
      cursor
    }
    pageInfo{
      startCursor
      hasPreviousPage
    }
  }
}
```

Result:

```graphql
{
  "data": {
    "workchain_transactions": {
      "edges": [
        {
          "node": {
            "id": "transaction/beebd27cbc94a9a9fbd29f00eba00850f627d7e1cd063672da06c34af1e4e812",
            "now": 1646867620
          },
          "cursor": "5eb8b7em04"
        },
        {
          "node": {
            "id": "transaction/8475e48a6cb0e8aa8068d8eb7624b8a123ad4e51f9d005a60724e1b13b444338",
            "now": 1646867623
          },
          "cursor": "5eb8b7fm00"
        },
        {
          "node": {
            "id": "transaction/276ccd18e275bcc908c1e819a32abfcbee1c6a94679e43b20d28ae0035d0c208",
            "now": 1646867623
          },
          "cursor": "5eb8b7fm01"
        }
      ],
      "pageInfo": {
        "startCursor": "5eb8b7em04",
        "hasPreviousPage": true
      }
    }
  }
}
```

## Query transaction data

```graphql
query{
  transactions(filter:{
    id:{
      eq:"29948390d177f9ab10e48e3aad4d64af6f20441954d7e689cca5116e6ccbf5bf"
    }
  }){
    id
    tr_type
    tr_type_name
    aborted # if the transaction was executed successfully
    block_id
    account_addr
    balance_delta # how balance of account_addr has changed after transaction
    workchain_id
    lt # transaction logical time
    prev_trans_lt
    now # block time that contains transaction. transaction execution time
    outmsg_cnt # number of external messages, generated by the transaction
    orig_status_name
    end_status_name
    in_msg # message that produced the transaction
    in_message{
      msg_type_name
      src # account that sent the message
      dst # same as account_addr
      value # value attached to the message
    }
  }
}
```

The result:

```graphql
{
  "data": {
    "transactions": [
      {
        "id": "29948390d177f9ab10e48e3aad4d64af6f20441954d7e689cca5116e6ccbf5bf",
        "tr_type": 0,
        "tr_type_name": "Ordinary",
        "aborted": false,
        "block_id": "1c93bad89390b71ceb537707cff49167aabe6fbaa65e28c8357e12570c67c644",
        "account_addr": "-1:f6967e2ce65843a5cc450362b898e87a0fab3925bdc507195fa5003465cd62af",
        "balance_delta": "0x9520368f50aab",
        "workchain_id": -1,
        "lt": "0x448c10cd4c1",
        "prev_trans_lt": "0x4093667f781",
        "now": 1599752024,
        "outmsg_cnt": 0,
        "orig_status_name": "Active",
        "end_status_name": "Active",
        "in_msg": "0e82f3c1c5f7e0414257954370c02890ad9046f5f2c0c9e1d7119591be7ae93f",
        "in_message": {
          "msg_type_name": "Internal",
          "src": "0:d1938ecc8a53ae58a6bf4416f9045a80b533227d79463b25424a8fd7c6de88fe",
          "dst": "-1:f6967e2ce65843a5cc450362b898e87a0fab3925bdc507195fa5003465cd62af",
          "value": "0x95203900d92ee"
        }
      }
    ]
  }
}
```

## Get the number of transactions in a specified shard over a period of time.

Here we specify the only shard of "-1" workchain and time from 18.43 till 19.43. You can do the same for any shard of "0" workchain.

```graphql
query{
  aggregateBlocks(filter:{
    workchain_id:{
      eq:-1
    }
    shard:{
      eq:"8000000000000000"
    }
    gen_utime:{
      gt:1596393798 # Date and time (GMT): Sunday, August 2, 2020 18:43:18
      lt:1596397406 # Date and time (GMT): Sunday, August 2, 2020 19:43:18

    }
  },
    fields:[
      { field: "tr_count", fn:SUM },
    ]
  )
}
```

Result:

```graphql
{
  "data": {
    "aggregateBlocks": [
      "4447"
    ]
  }
}
```
